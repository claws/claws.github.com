---
layout: post
title: "Create Your Own Weather Report Audio Track Using Current BOM Data"
tags:
 - python
 - txbom
 - BOM
 - weather
meta-description: 
# Don't change the disqus identifier even if the url changes. It uniquely
# associates comments with the post.
disqus-identifier: "create_your_own_weather_report_audio_track_using_current_bom_data"
summary: A method for generating your own spoken word weather report using data from the Australian BoM
---

<!-- excerpt start -->
This post presents a script for generating your own weather report audio
track based on current forecast and observation weather data retrieved 
from the [Australian Bureau of Meteorology](http://www.bom.gov.au/) (BOM) site.
<!-- excerpt end -->

I wrote this script to generate a localised weather report audio file 
that I could play as the first track in my morning alarm playlist on my Squeezebox 
Boom digital audio device.

The weather report track has intro and outro jingles attached. I have 
found this approach very useful in cueing my sleepy brain to recognise that the 
weather report is about to be played and hence I am more likely to pay attention
to it.

An example of the audio file produced by the script can be found here: [weather_report.mp3](/resources/weather_report.mp3)

<script src="https://gist.github.com/2819315.js"> </script>

#### How to use the script

First get any [dependencies](#deps) then download the following 3 files into a common directory:

  - [weather_report.py](https://gist.github.com/2819315), 
  - [intro.mp3](/resources/intro.mp3)
  - [outro.mp3](/resources/outro.mp3)

You are now ready to run the script...

  {% highlight bash %}
  $ python weather_report.py
  {% endhighlight %}
  
Which should produce log output such as:

  {% highlight bash %}
  $ python weather_report.py
  2012-05-28 07:31:44,126 - INFO - Retrieving forecast and observation data
  2012-05-28 07:31:45,486 - INFO - Forecast and observation data retrieval successful
  2012-05-28 07:31:45,486 - INFO - Generating weather report
  2012-05-28 07:31:47,299 - INFO - Finished generating weather report: weather_report.mp3
  {% endhighlight %}

If no errors were raised you should now have a weather_report.mp3 in the same directory.

Using the default weather report template, the words spoken in the weather report audio track will be similar to this:

<pre>
Current weather conditions for Adelaide, South Australia on Monday 28 May 2012 at 07:30am.
The apparent temperature is 9.2 degrees.
The wind is blowing from a north north westerly direction at 0 kilometers per hour, 
gusting to 0 kilometers per hour.
Latest forecast for Adelaide South Australia issued on Monday 28 May 2012 at 5:20 am.
Monday 28 May
Cloudy. Isolated light showers about the hills and southern suburbs this morning. Winds south to southeasterly and light.
Today's top temperature is forecast to be 17.
This concludes the automated weather report.
</pre>

<code></code>
#### Customise it for you

To customise the script for your own location you would likely modify: 

  - <code>forecast_id</code>, 
  - <code>observation_id</code> and 
  - <code>report_template</code> 

variables in <code>[weather_report.py](https://gist.github.com/2819315)</code> to contain 
appropriate values for you. The forecast identifier and observation JSON url can be found 
on the BOM web site. 

You may also want to change where the mp3 file gets generated by modifying the
<code>weather_report_mp3_file</code> path to something different.

If you want to change the jingles played before and after the weather report
then substitute your own files for my [intro.mp3](/resources/intro.mp3) and 
[outro.mp3](/resources/outro.mp3) files. The jingle tracks must be 44.1kHz 
mono tracks to match the weather report track.

If the intro and outro track are not present then the audio file will just contain
the spoken weather report.

Enjoy.


<code></code>
#### <a id="deps"></a>Software Dependencies

If you want to make use of this script there are a few things that you might need
to install.

This script was written to run on OS X, however by adapting the TTS command line
and voice name it is likely that this approach would also work on Linux.


* Xcode

  Apple's Xcode developer environment was used to provide the tools necessary to build lame and ffmpeg.

* lame

  Download the tar.gz from Sourceforge site, extract and then:
  {% highlight bash %}
  ./configure
  make
  sudo make install
  {% endhighlight %}
  
* ffmpeg (enabling libmp3lame)

  Download the tar.gz from Sourceforge site, extract and then:
  {% highlight bash %}
  ./configure --enable-libmp3lame --enable-shared --arch=x86_64
  make
  sudo make install
  {% endhighlight %}
  
* [Python](http://python.org/)
  
  - [Twisted](http://twistedmatrix.com/)
  - [txbom](https://github.com/claws/txBOM)
 
* jingle audio resources files (copy these into same directory as [weather_report.py](https://gist.github.com/2819315) file):
  
  - [intro.mp3](/resources/intro.mp3)
  - [outro.mp3](/resources/outro.mp3)



